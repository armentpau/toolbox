{"Name":"Dynamic Folder Export","Objects":[{"Type":"DynamicFolder","Name":"ExampleFolder","ScriptInterpreter":"powershell","DynamicCredentialScriptInterpreter":"json","Script":"Import-Module ActiveDirectory\r\n[System.Collections.ArrayList]$array = @()\r\nforeach ($computer in Get-ADComputer -SearchBase \"ou=Enterprise Servers,dc=company,dc=pri\" -Filter * -SearchScope subtree -Properties canonicalname)\r\n{\r\n\t$array.add((\r\n\t\t\tNew-Object -TypeName System.Management.Automation.PSObject -Property @{\r\n\t\t\t\t\"Type\" = \"RemoteDesktopConnection\";\r\n\t\t\t\t\"Name\" = $computer.name;\r\n\t\t\t\t\"ComputerName\" = $computer.name;\r\n\t\t\t\t\"credentialName\" = \"mikes\";\r\n\t\t\t\t\"Path\" = $computer.canonicalname.replace(\"/$($computer.name)\", \"\")\r\n\t\t\t}\r\n\t\t)) | Out-Null\r\n}\r\n$array = $array | Sort-Object -Property path\r\n$hash = @{ }\r\n$hash.add(\"Objects\", $array)\r\n\r\n$hash | ConvertTo-Json"}]}